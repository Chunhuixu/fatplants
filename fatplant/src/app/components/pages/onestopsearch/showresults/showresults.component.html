<mat-progress-bar id="loading-bar" mode="indeterminate" *ngIf="this.dataService.loading"></mat-progress-bar>

  <div class="row" style="width: 100%">
    <div class="column left" id="stepper">
      <h3>{{proteinDatabase}}</h3>
      <h3>Uniprot ID: {{uniprot_id}}</h3>
      <mat-vertical-stepper (selectionChange)="changeConfig($event.selectedStep.label)" disableRipple="true">
        <ng-template matStepperIcon="number">
        </ng-template>
        <mat-step class="nav-item" #summaryStep [class.active]="isSummary" label="Summary" [completed]='false'></mat-step>
        <mat-step class="nav-item" #structureStep [class.active]="isStructure" label="Structure" [completed]='false'></mat-step>
        <mat-step class="nav-item" #blastStep [class.active]="isBlast" label="Blast" [completed]='false'></mat-step>
        <mat-step class="nav-item" #pathwayStep [class.active]="isPathway" label="Pathway" [completed]='false'></mat-step>
      </mat-vertical-stepper>
      <div id="arrow-wrapper">
        <mat-icon id="left-arrow" [class.disabled-arrow]="!this.leftArrowEnabled" [class.enabled-arrow]="this.leftArrowEnabled" 
        matTooltip="Previous Tab" matTooltipPosition="below" [matTooltipDisabled]="!this.leftArrowEnabled" 
        (click)="arrowSelect('left', summaryStep, structureStep, blastStep, pathwayStep)">keyboard_arrow_left</mat-icon>
        <span id="arrow-label">{{prettyConfig}}</span>
        <mat-icon id="right-arrow"[class.disabled-arrow]="!this.rightArrowEnabled" [class.enabled-arrow]="this.rightArrowEnabled" 
        matTooltip="Next Tab" matTooltipPosition="below" [matTooltipDisabled]="!this.rightArrowEnabled" 
        (click)="arrowSelect('right', summaryStep, structureStep, blastStep, pathwayStep)">keyboard_arrow_right</mat-icon>
      </div>
    </div>

<!--    summary-->
    <div *ngIf="isSummary">
    <div class="column middle">
      <h2>Summary</h2>
      <div class="row">
        <table class="flat-table">
          <tr>
            <th><strong>Gene Name: </strong></th>
            <td>{{this.lmpd.gene_name}}</td>
          </tr>
          <tr>
            <th><strong>Protein Name: </strong></th>
            <td>{{this.lmpd.protein_name}}</td>
          </tr>
          <tr>
            <th><strong>Species: </strong></th>
            <td>{{this.lmpd.species}}</td>
          </tr>
          <tr>
            <th><strong>Species Long: </strong></th>
            <td>{{this.lmpd.species_long}}</td>
          </tr>
        </table>
      </div>
      <br>
      <div class="row">
        <mat-progress-bar id="pdb-loading-bar" mode="indeterminate" *ngIf="g2sLoading"></mat-progress-bar>
        <label *ngIf="!g2sLoading && noPdb">No PDB match found.</label>
        <iframe [src]="defaultPdb" style="transform: scale(1);transform-origin: 0 0;width: 100%; min-height: 600px" *ngIf="!g2sLoading && !noPdb"></iframe>
      </div>

    </div>

    <div class="column right">
      <h2>Detail</h2>
      <div class="row">
                <table class="flat-table">
                  <tr>
                    <th><strong>Gene Symbol: </strong></th>
                    <td>{{this.lmpd.gene_symbol}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Lmp ID: </strong></th>
                    <td>{{this.lmpd.lmp_id}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein mrna id: </strong></th>
                    <td>{{this.lmpd.mrna_id}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Entry: </strong></th>
                    <td>{{this.lmpd.protein_entry}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein GI: </strong></th>
                    <td>{{this.lmpd.protein_gi}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Refseq ID: </strong></th>
                    <td>{{this.lmpd.refseq_id}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Sequence Length: </strong></th>
                    <td>{{this.lmpd.species_long}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Tax ID: </strong></th>
                    <td>{{this.lmpd.taxid}}</td>
                  </tr>
                  <tr>
                    <th><strong>Protein Uniprot ID: </strong></th>
                    <td>{{this.lmpd.uniprot_id}}</td>
                  </tr>
                </table>
      </div>
        <h2>Sequence</h2>
        <div id="sequence-display">{{this.lmpd.sequence}}
        <button mat-raised-button ngxClipboard id="sequence-button" color="primary" [cbContent]="this.lmpd.sequence"
         (click)="this.notificationService.popup('Copied to Clipboard!')">Copy Sequence</button>
        </div>
    </div>
  </div>
<!--    structure-->
    <div class="column middleright" *ngIf="isStructure">
      <div *ngIf="noPdb && !g2sLoading" class="centered">No PDB matches found.</div>
      <mat-progress-bar mode="indeterminate" *ngIf="g2sLoading"></mat-progress-bar>
      <mat-table [dataSource]='G2SDataSource' id='table' *ngIf="!g2sLoading">
        <ng-container matColumnDef="pdbId">
          <mat-header-cell *matHeaderCellDef mat-sort-header> pdbId </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.pdbId}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="pdbNo">
          <mat-header-cell *matHeaderCellDef mat-sort-header> pdbNo </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.pdbNo}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="chain">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Chain </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.chain}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="evalue">
          <mat-header-cell *matHeaderCellDef mat-sort-header> EValue </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.evalue}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="bitscore">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Bitscore </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.bitscore}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="identity">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Identity - IdentityPositive </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.identity}} / {{elem.identityPositive}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="pdbRange">
          <mat-header-cell *matHeaderCellDef mat-sort-header> pdb From-To </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.pdbFrom}}-{{elem.pdbTo}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="seqRange">
          <mat-header-cell *matHeaderCellDef mat-sort-header> seq From-To </mat-header-cell>
          <mat-cell *matCellDef="let elem"> {{elem.seqFrom}}-{{elem.seqTo}} </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="3DViewer">
          <mat-header-cell *matHeaderCellDef mat-sort-header>3D Viewer </mat-header-cell>
          <mat-cell *matCellDef="let elem">
            <button mat-raised-button color="primary" class="viewer-button" (click)="showViewer(elem.pdbId)">
              <mat-icon [matTooltip]="'View ' + elem.pdbId">launch</mat-icon>
            </button>
          </mat-cell>
        </ng-container> 
        <ng-container matColumnDef="3DViewer2">
          <mat-header-cell *matHeaderCellDef mat-sort-header>MUSite</mat-header-cell>
          <mat-cell *matCellDef="let elem">
            <a mat-button href="https://www.musite.net/display3d.html?url=rcsb://{{elem.pdbId}}&sele=&position=" target="_blank">
              <mat-icon [matTooltip]="'Visit MUSite for ' + elem.pdbId">exit_to_app</mat-icon>
            </a>
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true;"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
      </mat-table>
      <!-- <mat-tab-group style="color: #4CAF50" style="width: 100%" height="768" animationDuration="0ms" *ngIf="!noPdb">
        <mat-tab *ngFor="let pdb of pdbList" label="{{pdb.name}}">
          <ng-template matTabContent>
            <iframe [src]="pdb.url" style="width: 100%" height="768"></iframe>
          </ng-template>
        </mat-tab>
      </mat-tab-group> -->
    </div>
<!--    blast-->
    <div class="column middleright" *ngIf="isBlast">
      <div class="row centered" *ngIf="showProgress">
        <circle-progress
          [percent]="percent"
          [radius]="100"
          [outerStrokeWidth]="16"
          [innerStrokeWidth]="8"
          [outerStrokeColor]="'#78C000'"
          [innerStrokeColor]="'#C7E596'"
          [animation]="true"
          [animationDuration]="300"
          [startFromZero]="false"
        ></circle-progress>
      </div>

      <div class="row" *ngFor="let res of showBlastResList">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{res[0]}}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <pre>{{res[1]}}</pre>
            </mat-expansion-panel>
          </mat-accordion>

      </div>
    </div>
<!--    pathway-->
    <div class="column middleright" *ngIf="isPathway">
      <div class="centered" *ngIf="pathwayList.length == 0">No pathway diagrams found in our database.</div>
      <mat-tab-group style="color: #4CAF50" style="min-height: 600px" id="pathway-tabs" animationDuration="0ms" *ngIf="pathwayList.length > 0">
        <mat-tab *ngFor="let pathway of pathwayList" label="{{pathway.name}}">
          <ng-template matTabContent>
            <iframe id="pathway-view" [src]="pathway.url"></iframe>
          </ng-template>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>

